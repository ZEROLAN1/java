# 快速开始指南

## 🎉 项目改造完成

已将传统的 Spring Boot + Thymeleaf 单体应用改造为现代化的**前后端分离架构**：

### 技术栈
- **后端**: Spring Boot + JWT + REST API
- **前端**: React + Vite + TailwindCSS
- **数据库**: MySQL 8.0
- **部署**: Docker + Docker Compose

---

## 🚀 一键部署（推荐）

### 方法一：Docker Compose（最简单）

```bash
# 1. 进入项目目录
cd d:\cloud\java-cloud-storage

# 2. 启动所有服务（前端 + 后端 + 数据库）
docker-compose up -d

# 3. 查看启动状态
docker-compose ps

# 4. 访问应用
# 浏览器打开: http://localhost
```

就这么简单！应用会在 http://localhost 运行。

### 停止服务

```bash
docker-compose down
```

---

## 💻 本地开发

### 后端开发

```bash
# 1. 确保 MySQL 正在运行
# 2. 运行后端
mvn spring-boot:run

# 后端运行在 http://localhost:8080
```

### 前端开发

```bash
# 1. 进入前端目录
cd frontend

# 2. 安装依赖
npm install

# 3. 启动开发服务器
npm run dev

# 前端运行在 http://localhost:3000
```

---

## 🌐 云服务器部署

### 准备工作
- 一台 Linux 服务器（Ubuntu/CentOS）
- 2GB+ 内存，10GB+ 硬盘

### 部署步骤

```bash
# 1. 连接服务器
ssh root@你的服务器IP

# 2. 安装 Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sh get-docker.sh

# 3. 安装 Docker Compose
curl -L "https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
chmod +x /usr/local/bin/docker-compose

# 4. 上传项目到服务器（使用 git 或 scp）
git clone <your-repository>
cd java-cloud-storage

# 5. 修改数据库密码（重要！）
nano docker-compose.yml
# 修改 MYSQL_ROOT_PASSWORD

# 6. 启动服务
docker-compose up -d

# 7. 开放端口
ufw allow 80/tcp

# 8. 访问应用
# 浏览器打开: http://你的服务器IP
```

---

## 📁 项目结构

```
java-cloud-storage/
├── src/                    # 后端源码
│   ├── main/java/com/cloudstorage/
│   │   ├── config/        # JWT、Security 配置
│   │   ├── controller/    # REST API 控制器
│   │   │   ├── AuthController.java     # 登录/注册
│   │   │   └── FileController.java     # 文件管理
│   │   ├── dto/           # 数据传输对象
│   │   ├── model/         # 实体类（User、File）
│   │   ├── repository/    # 数据访问层
│   │   └── service/       # 业务逻辑
│   └── resources/
│       └── application.properties
│
├── frontend/              # 前端源码
│   ├── src/
│   │   ├── pages/        # 页面组件
│   │   │   ├── Login.jsx      # 登录页
│   │   │   ├── Register.jsx   # 注册页
│   │   │   └── Dashboard.jsx  # 文件管理页
│   │   ├── context/      # 认证上下文
│   │   └── App.jsx       # 主应用
│   ├── Dockerfile        # 前端容器
│   └── nginx.conf        # Nginx 配置
│
├── docker-compose.yml    # 容器编排配置
├── Dockerfile           # 后端容器
├── README.md            # 详细文档
└── DEPLOYMENT.md        # 部署指南
```

---

## 🔧 主要改动

### 后端改造
✅ 移除 Thymeleaf 视图层  
✅ 添加 JWT 认证机制  
✅ 改造为 RESTful API  
✅ 添加 CORS 跨域支持  
✅ 创建 DTO 数据传输对象  
✅ 优化 Security 配置  

### 前端创建
✅ 使用 React 18 + Vite  
✅ TailwindCSS 现代化 UI  
✅ 响应式设计  
✅ JWT Token 管理  
✅ 文件上传/下载/删除功能  
✅ 漂亮的登录/注册页面  

### 部署优化
✅ Docker 多阶段构建  
✅ Nginx 反向代理  
✅ 前后端分离部署  
✅ 生产环境配置  

---

## 📝 API 接口

### 认证接口
- `POST /api/auth/register` - 用户注册
- `POST /api/auth/login` - 用户登录

### 文件接口（需要 JWT Token）
- `GET /api/files` - 获取文件列表
- `POST /api/files/upload` - 上传文件
- `GET /api/files/download/{id}` - 下载文件
- `DELETE /api/files/{id}` - 删除文件

---

## 🎨 界面预览

### 功能特性
- 🔐 用户注册和登录（JWT 认证）
- 📤 文件上传（支持最大 10MB）
- 📥 文件下载
- 🗑️ 文件删除
- 📊 文件列表展示
- 💎 现代化响应式 UI
- 🎯 文件类型图标识别

---

## 🛠️ 常用命令

### Docker 命令

```bash
# 启动服务
docker-compose up -d

# 停止服务
docker-compose down

# 查看日志
docker-compose logs -f

# 查看运行状态
docker-compose ps

# 重启服务
docker-compose restart

# 重新构建
docker-compose build --no-cache
docker-compose up -d
```

### 维护命令

```bash
# 查看容器资源使用
docker stats

# 清理未使用的镜像
docker image prune -a

# 备份数据库
docker exec cloud-storage-db mysqldump -uroot -ppassword cloud_storage > backup.sql

# 恢复数据库
docker exec -i cloud-storage-db mysql -uroot -ppassword cloud_storage < backup.sql
```

---

## ⚠️ 注意事项

1. **生产环境务必修改密码**
   - 修改 `docker-compose.yml` 中的 `MYSQL_ROOT_PASSWORD`
   - 修改 `application.properties` 中的 `jwt.secret`

2. **防火墙配置**
   - 开放 80 端口（HTTP）
   - 开放 443 端口（HTTPS，如果需要）

3. **域名和 HTTPS**
   - 参考 `DEPLOYMENT.md` 配置 SSL 证书

4. **定期备份**
   - 数据库数据
   - 上传的文件

---

## 📚 更多文档

- **README.md** - 完整项目文档
- **DEPLOYMENT.md** - 详细部署指南（包含 HTTPS 配置）

---

## ❓ 问题排查

### 端口被占用
修改 `docker-compose.yml` 中的端口映射

### 容器启动失败
```bash
docker-compose logs
```

### 数据库连接失败
```bash
docker-compose logs db
```

### 前端无法访问
检查浏览器控制台错误信息

---

## 🎓 快速测试

1. 启动服务后，打开 http://localhost
2. 点击"立即注册"创建账户
3. 登录后进入文件管理页面
4. 点击"选择文件"上传测试文件
5. 尝试下载和删除功能

---

## 📞 技术支持

如有问题，请查看详细文档或提交 Issue。

**祝您使用愉快！** 🎉
